{% extends "base.html" %}

{% block title %}Negocios - Superadmin{% endblock %}

{% block content %}
<main class="min-h-screen bg-slate-50 py-6">
    <div class="max-w-6xl mx-auto px-4">
        <section class="bg-white rounded-2xl shadow-sm border border-slate-100 p-4 sm:p-6">
            <header class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-6">
                <div>
                    <h1 class="text-xl sm:text-2xl font-semibold text-slate-900">
                        Negocios
                    </h1>
                    <p class="text-sm text-slate-500 mt-1">
                        Vista global de todos los negocios registrados en miniWMS.
                    </p>
                </div>

                <!-- Navegación superadmin -->
                <nav class="flex flex-wrap gap-2 justify-start sm:justify-end">
                    <a href="/superadmin/dashboard"
                       class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-slate-200 text-slate-700 bg-white hover:bg-slate-50">
                        Dashboard
                    </a>
                    <a href="/superadmin/negocios"
                       class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-indigo-200 text-indigo-700 bg-indigo-50">
                        Negocios
                    </a>
                    <a href="/superadmin/alertas"
                       class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium border border-amber-200 text-amber-700 bg-amber-50 hover:bg-amber-100">
                        Alertas
                    </a>
                </nav>
            </header>

            {% if negocios %}
            <div class="overflow-x-auto -mx-4 sm:mx-0">
                <table class="min-w-full text-sm text-left border-separate border-spacing-y-1">
                    <thead>
                        <tr class="text-xs font-medium text-slate-500 uppercase">
                            <th class="px-4 py-2">Negocio</th>
                            <th class="px-4 py-2">Plan</th>
                            <th class="px-4 py-2">Estado</th>
                            <th class="px-4 py-2 text-right">Usuarios</th>
                            <th class="px-4 py-2 text-right">Productos</th>
                            <th class="px-4 py-2 text-right">Mov. 30 días</th>
                            <th class="px-4 py-2">Último acceso</th>
                            <th class="px-4 py-2 text-right">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for n in negocios %}
                        <tr class="bg-slate-50/60 hover:bg-slate-100 transition-colors">
                            <td class="px-4 py-2 align-middle">
                                <div class="flex flex-col">
                                    <span class="font-medium text-slate-900">{{ n.nombre }}</span>
                                    <span class="text-xs text-slate-500">ID {{ n.id }}</span>
                                </div>
                            </td>
                            <td class="px-4 py-2 align-middle">
                                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-indigo-50 text-indigo-700 border border-indigo-100">
                                    {{ n.plan|upper }}
                                </span>
                            </td>
                            <td class="px-4 py-2 align-middle">
                                {% if n.estado == "activo" %}
                                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-50 text-emerald-700 border border-emerald-100">
                                    Activo
                                </span>
                                {% else %}
                                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-rose-50 text-rose-700 border border-rose-100">
                                    {{ n.estado|capitalize }}
                                </span>
                                {% endif %}
                            </td>
                            <td class="px-4 py-2 text-right align-middle text-slate-700">
                                {{ n.usuarios }}
                            </td>
                            <td class="px-4 py-2 text-right align-middle text-slate-700">
                                {{ n.productos }}
                            </td>
                            <td class="px-4 py-2 text-right align-middle text-slate-700">
                                {{ n.movimientos_30d }}
                            </td>
                            <td class="px-4 py-2 align-middle text-xs text-slate-500">
                                {% if n.ultimo_acceso %}
                                {{ n.ultimo_acceso.strftime("%d-%m-%Y %H:%M") }}
                                {% else %}
                                —
                                {% endif %}
                            </td>
                            <td class="px-4 py-2 text-right align-middle">
                                <a href="/superadmin/negocios/{{ n.id }}"
                                   class="inline-flex items-center px-2.5 py-1.5 rounded-full text-xs font-medium border border-slate-200 text-slate-700 bg-white hover:bg-slate-50">
                                    Detalle
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="text-sm text-slate-500">
                Aún no hay negocios registrados.
            </p>
            {% endif %}
        </section>
    </div>
</main>
{% endblock %}
